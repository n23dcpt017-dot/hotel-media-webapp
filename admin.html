<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Admin - Hotel Media (Demo)</title>
  <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
  <header class="site-header"><div class="wrap"><h1>Admin (Demo)</h1></div></header>
  <main class="wrap container">
    <p>Trang admin demo: tạo/sửa/xóa bài trong backend nếu bạn chạy server</p>

    <section>
      <h3>Tạo bài mới</h3>
      <form id="postForm">
        <label>Title<br><input id="title" required></label><br>
        <label>Slug<br><input id="slug" required></label><br>
        <label>Summary<br><textarea id="summary"></textarea></label><br>
        <label>Content<br><textarea id="content"></textarea></label><br>
        <label>YouTube ID (optional)<br><input id="youtube"></label><br>
        <button type="submit">Tạo</button>
      </form>
      <div id="msg"></div>
    </section>

    <section>
      <h3>Danh sách bài (demo từ data/posts.json hoặc backend)</h3>
      <div id="list"></div>
    </section>
  </main>
  <script>
    const useBackend = false; // set true nếu bạn chạy backend
    const API_BASE = "http://localhost:4000/api";
    function loadPosts() {
      if (useBackend) {
        fetch(API_BASE + '/posts').then(r=>r.json()).then(renderList);
      } else {
        fetch('data/posts.json').then(r=>r.json()).then(renderList);
      }
    }
    function renderList(posts) {
      const list = document.getElementById('list');
      list.innerHTML = '';
      posts.forEach(p=>{
        const el = document.createElement('div');
        el.className = 'post';
        el.innerHTML = `<strong>${p.title}</strong> — <small>${p.slug}</small>`;
        list.appendChild(el);
      });
    }
    document.getElementById('postForm').addEventListener('submit', e=>{
      e.preventDefault();
      const newPost = {
        title: document.getElementById('title').value,
        slug: document.getElementById('slug').value,
        summary: document.getElementById('summary').value,
        content: document.getElementById('content').value,
        youtube: document.getElementById('youtube').value || '',
        status: 'published'
      };
      if (useBackend) {
        fetch(API_BASE + '/posts', {
          method: 'POST',
          headers: {'Content-Type':'application/json'},
          body: JSON.stringify(newPost)
        }).then(r=>r.json()).then(d=>{
          document.getElementById('msg').innerText = 'Đã tạo: ' + d.id;
          loadPosts();
        }).catch(err=>document.getElementById('msg').innerText = 'Lỗi: ' + err);
      } else {
        document.getElementById('msg').innerText = 'Demo local: bật backend để lưu bài';
      }
    });

    loadPosts();
  </script>
</body>
</html>
